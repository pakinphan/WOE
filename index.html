<!DOCTYPE html>
<html lang="th">

<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Interactive Experience</title>
    <style>
        body {
            margin: 0;
            padding: 0;
            font-family: 'Kanit', sans-serif;
            background-color: #000;
            color: #fff;
            display: flex;
            justify-content: center;
            align-items: center;
            height: 100vh;
            overflow: hidden;
        }

        .container {
            position: relative;
            width: 100%;
            max-width: 100%;
            height: 100%;
            overflow: hidden;
        }


        /* Video Section */
        #video-section {
            width: 100%;
            height: 100%;
            display: flex;
            justify-content: center;
            align-items: center;
            z-index: 10;
        }

        #intro-video {
            width: 100%;
            height: 100%;
            object-fit: cover;
        }

        /* Comic Section */
        #comic-section {
            display: none;
            width: 100%;
            height: 100%;
            background-color: #222;
            flex-direction: column;
            justify-content: center;
            align-items: center;
            z-index: 20;
        }

        .comic-title {
            font-size: 24px;
            margin-bottom: 20px;
            text-align: center;
        }

        .comic-container {
            display: grid;
            grid-template-columns: 1fr 1fr;
            grid-template-rows: 1fr 1fr;
            gap: 16px;
            width: 80%;
            height: 70%;
            position: relative;
        }

        .comic-panel {
            background-color: #444;
            position: relative;
            cursor: pointer;
            border-radius: 5px;
            overflow: hidden;
            display: flex;
            justify-content: center;
            align-items: center;
        }

        .comic-panel img {
            width: 100%;
            height: 100%;
            object-fit: cover;
            opacity: 0;
            transition: opacity 0.5s ease;
        }

        .comic-panel.revealed img {
            opacity: 1;
        }

        .comic-instruction {
            position: absolute;
            bottom: 40px;
            width: 100%;
            text-align: center;
            font-size: 16px;
            color: #fff;
        }

        /* Game Section */
        #game-section {
            display: none;
            width: 100%;
            height: 100%;
            background-image: url('/api/placeholder/800/450');
            background-size: cover;
            position: relative;
            z-index: 30;
        }

        #character {
            width: 40px;
            height: 60px;
            background-color: red;
            position: absolute;
            bottom: 60px;
            left: 100px;
            transition: left 0.2s ease;
            z-index: 2;
        }

        .item {
            width: 30px;
            height: 30px;
            background-color: gold;
            position: absolute;
            border-radius: 50%;
            cursor: pointer;
            z-index: 1;
        }

        #item1 {
            bottom: 70px;
            left: 200px;
        }

        #item2 {
            bottom: 100px;
            left: 400px;
        }

        #item3 {
            bottom: 70px;
            left: 600px;
        }

        #door {
            width: 50px;
            height: 80px;
            background-color: brown;
            position: absolute;
            bottom: 60px;
            right: 50px;
            cursor: not-allowed;
        }

        .game-instruction {
            position: absolute;
            top: 10px;
            left: 10px;
            background-color: rgba(0, 0, 0, 0.7);
            padding: 10px;
            border-radius: 5px;
        }

        .item-counter {
            position: absolute;
            top: 10px;
            right: 10px;
            background-color: rgba(0, 0, 0, 0.7);
            padding: 10px;
            border-radius: 5px;
        }

        .success-message {
            position: absolute;
            top: 50%;
            left: 50%;
            transform: translate(-50%, -50%);
            background-color: rgba(0, 0, 0, 0.8);
            padding: 20px;
            border-radius: 10px;
            text-align: center;
            display: none;
        }

        /* Animation fade styles */
        #video-section,
        #comic-section,
        #game-section {
            transition: opacity 1.2s ease;
            opacity: 1;
        }

        .fade-out {
            opacity: 0 !important;
        }

        .fade-in {
            animation: fadeIn 1.2s ease forwards;
        }

        @keyframes fadeIn {
            from {
                opacity: 0;
            }

            to {
                opacity: 1;
            }
        }
    </style>
</head>

<body>

    <div class="container">
        <!-- 1. Video Section -->
        <div id="video-section">
            <video id="intro-video" autoplay muted>
                <source src="/asset/video/Short2.mp4" type="video/mp4">
                Your browser does not support the video tag.
            </video>
        </div>

        <!-- 2. Comic Section -->

        <div id="comic-section" style="background-image: url(/asset/image/comic/1.png);">
            <div class="comic-container">
                <div class="comic-panel" data-panel="1">
                    <img src="/asset/image/comic/1.png" alt="Comic panel 1">
                </div>
                <div class="comic-panel" data-panel="2">
                    <img src="/asset/image/comic/2.png" alt="Comic panel 2">
                </div>
                <div class="comic-panel" data-panel="3">
                    <img src="/asset/image/comic/3.png" alt="Comic panel 3">
                </div>
                <div class="comic-panel" data-panel="4">
                    <img src="/asset/image/comic/4.png" alt="Comic panel 4">
                </div>
            </div>
            <div class="comic-instruction">คลิกเพื่อเปิดเผยเรื่องราว</div>
        </div>

        <!-- 3. Game Section -->
        <div id="game-section">
            <div class="game-instruction">ใช้ปุ่มลูกศรเพื่อเคลื่อนที่ และเก็บไอเทมทั้งหมดก่อนไปที่ประตู</div>
            <div class="item-counter">ไอเทม: <span id="items-collected">0</span>/3</div>
            <div id="character"></div>
            <div class="item" id="item1"></div>
            <div class="item" id="item2"></div>
            <div class="item" id="item3"></div>
            <div id="door"></div>
            <div class="success-message">
                <h2>ยินดีด้วย!</h2>
                <p>คุณผ่านด่านนี้แล้ว</p>
            </div>
        </div>
    </div>

    <script>
        // Global variables
        let currentPanelIndex = 0;
        let collectedItems = 0;
        let characterPosition = 100;
        let characterMoving = false;

        // Elements
        const videoSection = document.getElementById('video-section');
        const introVideo = document.getElementById('intro-video');
        const comicSection = document.getElementById('comic-section');
        const comicPanels = document.querySelectorAll('.comic-panel');
        const comicInstruction = document.querySelector('.comic-instruction');
        const gameSection = document.getElementById('game-section');
        const character = document.getElementById('character');
        const items = document.querySelectorAll('.item');
        const door = document.getElementById('door');
        const itemsCollectedDisplay = document.getElementById('items-collected');
        const successMessage = document.querySelector('.success-message');

        setTimeout(() => {
            // Add fade-out class to video section
            videoSection.classList.add('fade-out');
            
            // After the fade-out animation completes, hide video section and show comic section
            setTimeout(() => {
                videoSection.style.display = 'none';
                comicSection.style.display = 'flex';
                comicSection.classList.add('fade-in');
            }, 1200); // This matches the transition duration
        }, 3000);

        // Comic panel reveal logic
        comicSection.addEventListener('click', (e) => {
            // Reveal the next panel regardless of where the user clicks
            if (currentPanelIndex < comicPanels.length) {
                const nextPanel = document.querySelector(`.comic-panel[data-panel="${currentPanelIndex + 1}"]`);
                if (nextPanel) {
                    nextPanel.classList.add('revealed');
                    currentPanelIndex++;

                    if (currentPanelIndex === comicPanels.length) {
                        comicInstruction.textContent = 'คลิกที่ไหนก็ได้เพื่อเริ่มเกม';

                        // Add one more click to transition to game
                        comicSection.addEventListener('click', () => {
                            comicSection.style.display = 'none';
                            gameSection.style.display = 'block';
                            fullscreenBtn.style.display = 'block'; // Show fullscreen button in game section
                        }, { once: true });
                    }
                }
            }
        });

        // Game controls
        document.addEventListener('keydown', (e) => {
            if (gameSection.style.display === 'block') {
                const speed = 10;

                // Only allow left and right movement
                if (e.key === 'ArrowLeft') {
                    characterPosition = Math.max(0, characterPosition - speed);
                    character.style.left = characterPosition + 'px';
                } else if (e.key === 'ArrowRight') {
                    characterPosition = Math.min(760, characterPosition + speed);
                    character.style.left = characterPosition + 'px';
                }
            }
        });

        // Item collection
        items.forEach(item => {
            item.addEventListener('click', () => {
                item.style.display = 'none';
                collectedItems++;
                itemsCollectedDisplay.textContent = collectedItems;

                // Enable door when all items are collected
                if (collectedItems === 3) {
                    door.style.backgroundColor = 'green';
                    door.style.cursor = 'pointer';
                }
            });
        });

        // Door interaction
        door.addEventListener('click', () => {
            if (collectedItems === 3) {
                // Show success message
                successMessage.style.display = 'block';

                // You could transition to next level here if needed
                setTimeout(() => {
                    successMessage.textContent += "\n\nพร้อมที่จะไปต่อในฉากถัดไป!";
                }, 2000);
            }
        });

        // Make the dummy video actually appear to play
        introVideo.addEventListener('click', () => {
            introVideo.play();
        });

        
    </script>
</body>

</html>